# Types ディレクトリ

## 概要
アプリケーション全体で使用するTypeScript型定義をドメイン別に分割管理したディレクトリ。
CLAUDE.md仕様書に準拠したデータ型を適切に分離し、保守性と再利用性を向上させました。

## ファイル構成とドメイン分割

### index.ts - 統一エクスポートファイル
全ての型定義を統合し、後方互換性を維持するエクスポートファイル。
既存のインポートパスを変更することなく、分割された型定義を利用可能。

### common.ts - 共通基盤型
全ドメインで横断的に使用される基盤型定義。

**型定義:**
- `MealType`: 食事タイプ（'朝' | '昼' | '夜' | '間食'）
- `MealSourceType`: 献立ソースタイプ（'recipe' | 'stock'）
- `Quantity`: 数量と単位の基盤型（`{amount: string, unit: string}`）

**設計方針:**
- プロジェクト全体の型安全性の基盤
- シンプルかつ汎用性の高い型設計
- 他ドメインからの依存を受ける重要な型

### user.ts - ユーザー認証ドメイン
ユーザー管理・認証関連の型定義。

**型定義:**
- `User`: ユーザー情報（id, email, name, googleId, 作成・更新日時）

**特徴:**
- Google認証との統合対応
- 個人データ保護を考慮した設計

### ingredient.ts - 食材管理ドメイン
食材マスタ・食材項目関連の型定義。

**型定義:**
- `IngredientItem`: 食材項目（name, quantity: Quantity）
- `Ingredient`: 食材マスタ（カテゴリ、価格、単位変換情報等）

**特徴:**
- Quantity型との完全統合
- ユーザー別食材マスタ管理
- 商品名正規化対応（original_name）
- 無限食材フラグ（調味料等）

### stock.ts - 在庫管理ドメイン
食材在庫関連の型定義。

**型定義:**
- `StockItem`: 在庫アイテム（数量、賞味期限、保存場所、作り置きフラグ等）

**特徴:**
- Quantity型による型安全な数量管理
- 賞味期限管理とアラート対応
- 作り置き料理の管理機能

### meal.ts - 献立管理ドメイン（最重要）
献立計画関連の型定義。使用頻度が最も高いドメイン。

**型定義:**
- `MealPlan`: 献立計画（日付、食事タイプ、食材リスト、消費状態等）

**特徴:**
- レシピ・在庫両対応のソース管理
- 消費状態トラッキング（pending/completed/stored）
- 食材リストの型安全管理

### recipe.ts - レシピ管理ドメイン（拡張済み）
レシピ関連の包括的型定義。

**型定義:**
- `SavedRecipe`: 保存済みレシピ（URL、食材リスト、タグ等）
- `Recipe`: レシピ情報（調理時間、コスト、メモ等）
- `RecipeIngredient`: レシピ食材関連
- `RecipeFormData`: レシピフォーム専用型
- `CreateRecipeData`, `UpdateRecipeData`: CRUD操作用型

**特徴:**
- レシピURL管理と食材自動抽出対応
- 外部レシピサイトとの連携
- フォーム・CRUD操作の型安全性

### shopping.ts - 買い物管理ドメイン
買い物リスト関連の型定義。

**型定義:**
- `ShoppingListItem`: 買い物リストアイテム（数量、チェック状態、追加方法等）

**特徴:**
- 手動・自動追加の区別管理
- Quantity型による数量管理

### cost.ts - コスト管理ドメイン
支出記録関連の型定義。

**型定義:**
- `CostRecord`: コスト記録（金額、説明、外食フラグ等）

**特徴:**
- 自炊・外食の区別管理
- 詳細な支出トラッキング

## 分割効果と改善点

### Before（分割前）
- **単一ファイル**: `index.ts` 135行
- **型混在**: 8ドメインの型が混在
- **保守性**: 依存関係が不明確

### After（分割後）
- **8ファイル**: ドメイン別に適切分割
- **明確な責務**: 各ファイル10-30行の適切サイズ
- **型安全性**: 循環依存なしの綺麗な依存関係

### 依存関係図
```
common.ts (基盤)
├── user.ts (独立)
├── ingredient.ts (common依存)
│   ├── stock.ts (common + ingredient依存)
│   ├── meal.ts (common + ingredient依存)
│   ├── recipe.ts (common + ingredient依存)
│   └── shopping.ts (common依存)
└── cost.ts (独立)
```

### 使用頻度による最適化
1. **高頻度**: `MealPlan`(341回), `Quantity`(309回), `StockItem`(197回)
2. **中頻度**: `MealType`(76回), `Ingredient`(75回), `Recipe`(61回)
3. **低頻度**: `ShoppingListItem`(45回), `SavedRecipe`(29回)

頻度に応じた適切なファイル分割により、開発効率が向上。

## 後方互換性

### 既存コードへの影響
- **インポートパス**: 変更不要（`from '../types'`のまま）
- **型定義**: 完全互換（すべて再エクスポート）
- **ビルド**: 正常動作確認済み

### 新規開発での推奨方法
```typescript
// ドメイン別の直接インポート（推奨）
import type { MealPlan } from '../types/meal';
import type { StockItem } from '../types/stock';
import type { Quantity } from '../types/common';

// 統一インポート（既存コード互換）
import type { MealPlan, StockItem, Quantity } from '../types';
```

## 設計原則

### 型安全性
- すべての型でanyの使用禁止
- 厳密な型チェックの実施
- Quantity型による数量管理の統一

### 保守性
- ドメイン駆動設計による明確な分離
- 循環依存の完全回避
- 適切なファイルサイズ維持

### 拡張性
- 新しいドメインの追加が容易
- 既存型への影響最小化
- 段階的な型強化が可能

このドメイン別分割により、Cookletプロジェクトの型定義は保守性・拡張性・型安全性のすべてにおいて大幅に改善されました。