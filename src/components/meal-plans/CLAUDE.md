# Components/Meal-Plans ディレクトリ

## 概要
献立計画機能に関連するコンポーネントを管理するディレクトリ。MealPlansページのリファクタリングにより分離されたコンポーネント群。

## ファイル構成

### MealPlanDetail.tsx
献立詳細表示コンポーネント - 朝食・昼食・夕食の表示ロジックを統一したコンポーネント。

#### 実装済み機能

**統一された献立表示**
- 食事タイプ別のアイコン表示（朝：🌅、昼：🌞、夜：🌙、間食：🍪）
- 献立名表示（未設定時は［未設定］）
- 消費ステータス表示（完食・作り置き状態の視覚的表示）
- 食材リスト表示

**インタラクティブ操作**
- レシピリンクボタン（レシピURLがある場合のみ表示）
- 食べたボタン（未完了の献立のみ表示）
- 編集・追加ボタン（状態に応じて表示切り替え）
- ステータス変更ボタン（完了済み献立のみ表示）

#### Props

```typescript
interface MealPlanDetailProps {
  /** 食事タイプ */
  mealType: MealType;
  /** 献立データ（未設定の場合はnull） */
  mealPlan: MealPlan | null;
  /** 献立追加のハンドラー */
  onAddMeal: () => void;
  /** 献立編集のハンドラー */
  onEditMeal: () => void;
  /** 食べた状態変更のハンドラー */
  onCookedClick: () => void;
  /** ステータス変更のハンドラー */
  onStatusClick: () => void;
}
```

#### 設計思想

**コードの重複排除**
- MealPlans.tsxで朝食・昼食・夕食の同一ロジックが3回繰り返されていた問題を解決
- 約150行のコード重複を単一コンポーネントに統合

**設定駆動のアプローチ**
- `MEAL_CONFIGS`オブジェクトで食事タイプ別の設定を一元管理
- アイコン、名前、デフォルトメニュー名を設定で管理

**状態管理の分離**
- コンポーネント自体は表示ロジックのみを担当
- 状態変更は全てpropsのハンドラー関数経由で親コンポーネントに委譲

#### UI設計

**レスポンシブレイアウト**
- flexboxを使用した左右分割レイアウト
- 左側：献立情報表示、右側：操作ボタン群

**状態に応じた視覚的表現**
- 完了済み献立：取り消し線 + 透明度調整
- ステータスボタン：緑色のバッジ表示
- 未設定時：明確な［未設定］表示

**アクセシビリティ対応**
- title属性によるツールチップ表示
- ホバー効果による操作性向上
- 絵文字アイコンによる視覚的識別

#### 使用例

```typescript
// MealPlans.tsxでの使用例
<MealPlanDetail
  mealType="朝"
  mealPlan={getMealPlan(selectedDate, '朝')}
  onAddMeal={() => handleAddMeal(selectedDate, '朝')}
  onEditMeal={() => handleEditMeal(breakfastPlan!)}
  onCookedClick={() => handleCookedClick(breakfastPlan!)}
  onStatusClick={() => handleStatusClick(breakfastPlan!)}
/>
```

#### リファクタリング効果

**コード削減**
- MealPlans.tsxから約150行の重複コードを削除
- 保守性の大幅な向上

**拡張性向上**
- 新しい食事タイプ（間食など）の追加が容易
- 献立表示ロジックの変更が一箇所で完結

**テスタビリティ向上**
- 単一責任の独立コンポーネントとしてユニットテストが容易
- プロップスベースの純粋関数的設計

### WeeklyNavigation.tsx
週間ナビゲーションコンポーネント - MealPlans.tsxから分離された週間移動機能。

#### 実装済み機能
- 献立カレンダーのヘッダー表示（タイトル + 週範囲）
- 前週・次週ボタンによる週間移動
- 「今日」ボタンによる当日週への即座復帰
- ローディング状態とエラー状態の表示

#### Props
```typescript
interface WeeklyNavigationProps {
  currentWeekStart: Date;
  weekRange: string;
  onPreviousWeek: () => void;
  onNextWeek: () => void;
  onThisWeek: () => void;
  isCurrentWeek: boolean;
  loading?: boolean;
  error?: string | null;
}
```

### MealPlanCalendar.tsx
献立カレンダーコンポーネント - 週間の日付表示とインタラクション機能。

#### 実装済み機能
- 7列グリッドによる週間日付表示
- 曜日表示（日・月・火・水・木・金・土）
- 各日の献立有無をドット表示
- 今日の日付を青リングで強調
- 日付クリックによる選択状態変更

### MealPlanDayDetail.tsx
選択日の献立詳細表示コンポーネント - 朝昼夜の献立を統合表示。

#### 実装済み機能
- 選択日の日付表示（今日判定付き）
- 朝昼夜3食のMealPlanDetailコンポーネント統合
- 各食事タイプのハンドラー統一管理

### MealPlanSuggestion.tsx
献立提案機能コンポーネント - AI献立生成と週間サマリー表示。

#### 実装済み機能
- 週間サマリー表示（自炊・外食回数、予算）
- 今日の献立提案ボタン
- 週間献立提案ボタン
- 在庫食材・栄養バランス考慮の説明文

### CookedDialog.tsx
「作った！」ダイアログコンポーネント - 献立完了時の状態選択。

#### 実装済み機能
- 完食・作り置き選択ダイアログ
- 献立名の確認表示
- 作り置き選択時の在庫テーブル自動追加
- モーダルダイアログのアクセシビリティ対応

## リファクタリング効果

### MealPlans.tsx分割結果
- **元のサイズ**: 565行 → **分割後**: 約250行（56%削減）
- **責任分離**: 6つの独立コンポーネントに分割
- **保守性向上**: 各機能が独立してテスト・修正可能
- **再利用性向上**: 他ページでの部分的利用が可能

### 新規カスタムフック
- `useMealPlanCalendar` - 週間カレンダー状態管理フック
- 日付計算・週間ナビゲーション機能を分離
- テストしやすい純粋な状態管理ロジック

## 注意点
- MealType型には間食('間食')も含まれるが、現在の実装では朝・昼・夜のみ使用
- 将来的に間食表示が必要になった場合は追加設定が容易
- 日本語での食事タイプ（朝・昼・夜・間食）に準拠
- 絵文字アイコンの使用（Material Iconsではない）
- 各コンポーネントは独立しており、他機能への影響なし