# Cooklet - 献立管理アプリ 仕様書

## 1. プロジェクト基本情報

### Claude Code AIへの制約
すべての応答は、日本語で行われなければなりません。
**遵守** ソースコードには、読者の理解を助けるような日本語のコメントを書いてください。
**遵守** トークン節約のために、ソースコードがあるディレクトリにはCLAUDE.mdを生成し、配下のファイルに含まれるメゾットなどを要約してください。内容はClaudeが理解できれば一任します。
**遵守** ソースコードを参照するときは、まず各ディレクトリのCLAUDE.mdを参照してください。
**遵守** ソースコードを変更するときは、忘れずにCLAUDE.mdにも変更を反映してください。変更した仕様はすべてこのファイルに追記・修正してください。

### Martin Fowlerリファクタリング手法の適用
**遵守** すべてのリファクタリング作業は、Martin Fowlerの体系的手法に従って実行してください。
- **コードの匂い特定**: 問題箇所を体系的に分類・優先度付け
- **段階的実行**: 小さなステップでの安全な改善
- **テスト保護**: 各ステップでlint・build・動作確認を実施
- **文書化**: `.claude/DEVELOPMENT_LOG.md`への記録必須
- **テンプレート使用**: `.claude/DOC_TEMPLATES.md`のリファクタリングテンプレートを活用
ユーザの応答が必要なときには、以下のコマンドでユーザの操作を促す: `echo -e '\a'`
不要なパッケージは`pnpm uninstall`してください。
**遵守** 変数を定義するときは必ず型を記述してください。`any`は決して使用してはいけません。
**oxlint抑制コメント（`// oxlint-disable`）は決して使用してはいけません。**根本的な型安全性とコード品質の改善で解決してください。
適宜`pnpm run lint && pnpm run build:netlify`を実行して、コードの品質を維持してください。
- **pre-commit hook**: コミット前に自動でlintチェック実行（エラー時はコミット阻止）
- **pre-push hook**: プッシュ前に自動でlint & buildチェック実行（エラー時はプッシュ阻止）
- Git hookにより品質管理が自動化されているため、手動チェックは不要
`import`は、`import {...}`の形式を使用してください。`import ...`は使用しないでください。
**遵守** Github issueに着手する前に、該当のissueに修正方針のコメントを追加してください。
**遵守** Github issueの解決を確認したら、修正の概要をコメントし、Closeしてください。
変更を保存するため、キリがよく、かつ動作が確認できたタイミングで`git add . && git commit -m "wip" && git push`を実行してください。
**重要** キリのいいタイミングで、CLAUDE.mdの内容がコードベースと一致しているか確認し、不一致があれば修正してください。
**重要** 画面をまたいでUIの一貫性を維持してください。
**遵守** データベースの変更が必要な場合は、その旨をIssueのコメントやユーザへの返答で知らせてください。
**遵守** このプロジェクトのUIは、.claude/UI.mdの内容に従ってください。必要があれば追記してください。
**遵守** ほかのセッションでの意図しないrevertを防ぐため、機能変更の経緯と、バグ修正、引き継ぐべき事項を、.claude/DEVELOPMENT_LOG.mdに出力してください。変更を計画する前に必ず参照してください。
**遵守** 要素を追加するときは.claude/ELEMENTS.mdにある、既存の型、コンポーネント、関数を使用して作成してください。それで不可能な場合に、新しい要素を作成し、必ず.claude/ELEMENTS.mdに追加してください。
**推奨** Geminiはあなたの同僚で、調べ物に長けています。計画段階で、適宜`gemini -p <message>`を使って調査や相談を依頼してください。ただし、コードの変更はすべてClaude Codeが行ってください。

### 命名規則
- **変数名**: すべてlowerCamelCaseにする
- **DBカラム名**: snake_caseにする

### プロジェクト概要・目的
- **アプリ名**: Cooklet
- **概要**: 一人暮らしユーザーのための献立・在庫・買い物・コストを一元管理できるスマートな献立管理Webアプリ
- **目的**: レシピはURL管理とし、軽量かつシンプルなPWAとして設計
- **対象ユーザー**: 一人暮らしで自炊する個人ユーザー、献立・在庫・支出をシンプルに記録・管理したい人
- **本番URL**: https://cooklet.netlify.app

### 開発スタイル
- **個人開発**: 自分のペースで好きに開発
- **Claude Code**: コード生成支援による効率的な開発
- **Git**: GitHub、master（本番）ブランチで管理
- **自動デプロイ**: GitHub連携でNetlifyに自動デプロイ

## 2. 技術仕様・設計

詳細な技術仕様は以下のファイルを参照：
- **技術アーキテクチャ**: `.claude/TECH_SPECS.md`
- **UI設計**: `.claude/UI.md`
- **セキュリティ**: `.claude/SECURITY.md`

### 主要技術スタック
- **フロントエンド**: React + TypeScript + PWA
- **バックエンド**: Supabase（PostgreSQL + 認証）
- **ホスティング**: Netlify（自動デプロイ）
- **OCR**: Google Cloud Vision API + Netlify Functions
- **通知**: Web Push API

## 3. アプリ特徴

### 3.1 主な特徴
- **レシピはURL管理**、調理手順は非保存
- **食材はLLMでURLから自動抽出**（必要に応じて手動編集）
- **中途半端な食材・作り置きにも対応**した在庫管理
- 献立と在庫から**買い物リストを自動生成**
- **一食ごとの支出記録**（自炊・外食対応）
- **Web Push通知で賞味期限リマインド**（実装済み）
- **UIは軽量・高速を重視**、リッチな装飾は控える

## 4. 画面構成

詳細なUI設計・画面配置仕様は `.claude/UI.md` を参照


## 5. データ設計

詳細なデータベース設計・型定義は以下を参照：
- **データベーススキーマ**: `.claude/TECH_SPECS.md`
- **TypeScript型定義**: `.claude/ELEMENTS.md`

## 6. 関連ドキュメント

### 設計・仕様書
- **技術仕様**: `.claude/TECH_SPECS.md` - アーキテクチャ・DB設計・技術スタック
- **UI設計**: `.claude/UI.md` - 画面設計・レイアウト・ユーザビリティガイドライン
- **セキュリティ**: `.claude/SECURITY.md` - セキュリティ方針・実装ガイドライン

### 開発・運用
- **開発ログ**: `.claude/DEVELOPMENT_LOG.md` - 開発履歴・バグ修正・引き継ぎ事項・Martin Fowlerリファクタリング記録
- **要素定義**: `.claude/ELEMENTS.md` - 型・コンポーネント・関数の包括リスト
- **コーディングルール**: `.claude/CODING.md` - Martin Fowlerリファクタリング手法・コーディング標準・ベストプラクティス

### ドキュメント構成管理
- **ドキュメントテンプレート**: `.claude/DOC_TEMPLATES.md` - 標準的な文書作成テンプレート・Martin Fowlerリファクタリング記録テンプレート
- **コマンド統合**: 古いコマンドファイル（doc.md、lint.md、refactor.md）を削除、doc-update.mdに統合（2025-07-01）

## 7. 開発環境メモ

### サーバー起動・テスト方法
- 開発サーバーは、`nohup npm run dev &`で開始して、playwrightで`http://172.23.231.87:5174/`にアクセスして。確認が完了したら**必ず** killで終了させて。