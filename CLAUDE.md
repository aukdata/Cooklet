# Cooklet - 献立管理アプリ 仕様書

## 1. プロジェクト基本情報

### Claude Code AIへの制約
すべての応答は、日本語で行われなければなりません。
**遵守** ソースコードには、読者の理解を助けるような日本語のコメントを書いてください。
**遵守** トークン節約のために、ソースコードがあるディレクトリにはCLAUDE.mdを生成し、配下のファイルに含まれるメゾットなどを要約してください。内容はClaudeが理解できれば一任します。
**遵守** ソースコードを参照するときは、まず各ディレクトリのCLAUDE.mdを参照してください。
**遵守** ソースコードを変更するときは、忘れずにCLAUDE.mdにも変更を反映してください。変更した仕様はすべてこのファイルに追記・修正してください。
ユーザの応答が必要なときには、以下のコマンドでユーザの操作を促す: `echo -e '\a'`
不要なパッケージは`pnpm uninstall`してください。
**遵守** 変数を定義するときは必ず型を記述してください。`any`は決して使用してはいけません。
**oxlint抑制コメント（`// oxlint-disable`）は決して使用してはいけません。**根本的な型安全性とコード品質の改善で解決してください。
適宜`pnpm run lint && pnpm run build:netlify`を実行して、コードの品質を維持してください。
- **pre-commit hook**: コミット前に自動でlintチェック実行（エラー時はコミット阻止）
- **pre-push hook**: プッシュ前に自動でlint & buildチェック実行（エラー時はプッシュ阻止）
- Git hookにより品質管理が自動化されているため、手動チェックは不要
`import`は、`import {...}`の形式を使用してください。`import ...`は使用しないでください。
**遵守** Github issueに着手する前に、該当のissueに修正方針のコメントを追加してください。
**遵守** Github issueの解決を確認したら、修正の概要をコメントし、Closeしてください。
変更を保存するため、キリがよく、かつ動作が確認できたタイミングで`git add . && git commit -m "wip" && git push`を実行してください。
**重要** キリのいいタイミングで、CLAUDE.mdの内容がコードベースと一致しているか確認し、不一致があれば修正してください。
**重要** 画面をまたいでUIの一貫性を維持してください。
**遵守** データベースの変更が必要な場合は、その旨をIssueのコメントやユーザへの返答で知らせ、database/patch-***.sqlのような形式でパッチを出力してください。
**遵守** このプロジェクトのUIは、.claude/UI.mdの内容に従ってください。必要があれば追記してください。
**遵守** ほかのセッションでの意図しないrevertを防ぐため、機能変更の経緯と、バグ修正、引き継ぐべき事項を、.claude/DEVELOPMENT_LOG.mdに出力してください。変更を計画する前に必ず参照してください。
**遵守** 要素を追加するときは.claude/ELEMENTS.mdにある、既存の型、コンポーネント、関数を使用して作成してください。それで不可能な場合に、新しい要素を作成し、必ず.claude/ELEMENTS.mdに追加してください。

### 命名規則
- **変数名**: すべてlowerCamelCaseにする
- **DBカラム名**: snake_caseにする

### プロジェクト概要・目的
- **アプリ名**: Cooklet
- **概要**: 一人暮らしユーザーのための献立・在庫・買い物・コストを一元管理できるスマートな献立管理Webアプリ
- **目的**: レシピはURL管理とし、軽量かつシンプルなPWAとして設計
- **対象ユーザー**: 一人暮らしで自炊する個人ユーザー、献立・在庫・支出をシンプルに記録・管理したい人
- **本番URL**: https://cooklet.netlify.app

### 開発スタイル
- **個人開発**: 自分のペースで好きに開発
- **Claude Code**: AI支援による効率的な開発
- **Git**: GitHub、main（本番）ブランチで管理
- **自動デプロイ**: GitHub連携でNetlifyに自動デプロイ

## 2. 技術仕様・設計

詳細な技術仕様は以下のファイルを参照：
- **技術アーキテクチャ**: `.claude/TECH_SPECS.md`
- **TypeScript型定義**: `.claude/TYPESCRIPT_MIGRATION.md`
- **レシートOCR設計**: `.claude/RECEIPT_OCR_DESIGN.md`
- **UI設計**: `.claude/UI.md`
- **セキュリティ**: `.claude/SECURITY.md`

### 主要技術スタック
- **フロントエンド**: React + TypeScript + PWA
- **バックエンド**: Supabase（PostgreSQL + 認証）
- **ホスティング**: Netlify（自動デプロイ）
- **OCR**: Google Cloud Vision API + Netlify Functions
- **通知**: Web Push API

## 3. アプリ特徴

### 3.1 主な特徴
- **レシピはURL管理**、調理手順は非保存
- **食材はLLMでURLから自動抽出**（必要に応じて手動編集）
- **中途半端な食材・作り置きにも対応**した在庫管理
- 献立と在庫から**買い物リストを自動生成**
- **一食ごとの支出記録**（自炊・外食対応）
- **Web Push通知で賞味期限リマインド**（実装済み）
- **UIは軽量・高速を重視**、リッチな装飾は控える

## 4. グローバルタブ構成

アプリ下部のタブバーで画面遷移：

| タブ名 | 機能概要 |
|--------|----------|
| **サマリー** | 当日の献立・在庫アラート・出費概要の一括表示 |
| **献立** | 献立の週間プランを視覚的に確認・編集（今日から7日間表示） |
| **買い物** | 食材不足に基づいた買い物リスト表示・チェック管理 |
| **レシピ** | 外部レシピURLの保存と食材抽出の編集、管理 |
| **在庫** | 現在の在庫一覧表示・編集・賞味期限管理 |
| **コスト** | 自炊・外食を含む一食単位でのコスト記録・月別集計表示 |

## 5. UI要素の画面配置仕様

.Claude/UI.mdを参照


## 6. データベース設計

詳細なデータベーススキーマは `.claude/TECH_SPECS.md` を参照

**主要テーブル**:
- `users`: ユーザー情報・通知設定
- `meal_plans`: 献立データ（消費状態管理付き）
- `stock_items`: 食材在庫・賞味期限管理
- `shopping_list`: 買い物リスト
- `cost_records`: コスト記録
- `saved_recipes`: レシピURL保存

## 7. 関連ドキュメント

### 設計・仕様書
- **技術仕様**: `.claude/TECH_SPECS.md`
- **UI設計**: `.claude/UI.md`
- **TypeScript**: `.claude/TYPESCRIPT_MIGRATION.md`
- **レシートOCR**: `.claude/RECEIPT_OCR_DESIGN.md`
- **セキュリティ**: `.claude/SECURITY.md`

### 開発・運用
- **開発計画**: `.claude/DEVELOPMENT_PLAN.md`
- **開発ログ**: `.claude/DEVELOPMENT_LOG.md`
- **要素定義**: `.claude/ELEMENTS.md`
- **コーディングルール**: `.claude/CODING.md`